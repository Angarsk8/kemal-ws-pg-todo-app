"use strict";$(document).ready(function(){$(".add-task").on("click",function(n){n.preventDefault(),t(),$("#task-form").attr("note-action","CREATE").find("#submit-button").text("Create"),$("#input-form").modal("show")}),$("#input-form").on("shown.bs.modal",function(){$("#note-title").focus()}),$("#task-form").on("submit",function(t){t.preventDefault();var n=$("#task-form").attr("note-action"),e=$("[name=note_title]").val().trim(),a=$("[name=note_content]").val().trim(),o=parseInt($("#task-form").attr("note-id"));if(!e||!a)return!1;var s="CREATE"==n?{title:e,content:a,type:n}:{id:o,title:e,content:a,type:n},i=JSON.stringify(s);ws.send(i),$("#input-form").modal("hide")}),$("[name=note_content]").keypress(function(t){13==t.which&&$("#task-form").submit()}),$(".panels-wrapper").on("keypress","[contenteditable]",function(t){13==t.which&&$(this).blur()}),$(".panels-wrapper").on("click",".closing-icon, .delete-button",function(t){t.preventDefault();var n=parseInt($(this).parents(".note-panel").attr("note-id")),e=JSON.stringify({id:n,type:"DELETE"});$(this).parents(".note-panel").addClass("animated fadeOut"),setTimeout(function(){ws.send(e)},1e3)}),$(".panels-wrapper").on("blur","[contenteditable]",function(){var t=$(this).parents(".note-panel"),n=parseInt(t.attr("note-id")),e=t.find(".note-title-text").text(),a=t.find(".note-content").text(),o=JSON.stringify({id:n,title:e,content:a,type:"UPDATE"});$("[contenteditable]").each(function(){return $(this).attr("contenteditable","false")}),ws.send(o)}),$(".panels-wrapper").on("click",".edit-button",function(n){n.preventDefault(),t();var e=$(this).parents(".note-panel"),a=e.attr("note-id"),o=e.find(".note-title-text").text(),s=e.find(".note-content").text();$("[name=note_title]").val(o),$("[name=note_content]").val(s),$("#task-form").attr("note-action","UPDATE").attr("note-id",a).find("#submit-button").text("Update"),$("#input-form").modal("show")});var t=function(){$("#input-form").modal("hide"),$('input[name="note_title"]').val("").removeClass("error"),$('textarea[name="note_content"]').val("").removeClass("error"),$("label.error").remove()};$("#task-form").validate({rules:{note_title:{required:!0},note_content:{required:!0}},messages:{note_title:{required:"Please, enter a title for your note!"},note_content:{required:"Please, enter a description for your note!"}}})});var _location=location,hostname=_location.hostname,port=_location.port,ws=new WebSocket("ws://"+hostname+":"+port+"/notes");ws.onmessage=function(t){var n=JSON.parse(t.data),e=$(".note-panel").length,a=n.length,o=e==a||e>a?"":"animated fadeIn",s=n.map(function(t,e){return noteHTML(t,setAnimation(n,e,o))});$(".panels-wrapper").html(s)},ws.onclose=function(t){console.log("Connection Closed: "+t.reason)},ws.onerror=function(t){console.log("Socket Error: "+t.data)};var setAnimation=function(t,n,e){return t.length-1===n?e:""};setInterval(function(){ws.send(JSON.stringify({type:"PING"}))},1e4);var noteHTML=function(t,n){return'<div class="panel panel-default note-panel '+n+'" note-id="'+t.id+'">\n    <div class="panel-heading">\n      <h3 class="panel-title custom-typo-title note-title">\n        <span contenteditable="true" class="text-info note-title-text"  >'+t.title+'</span>\n        <span class="updated-text">\n          '+(t.created_at!==t.updated_at?"(updated)":"")+'\n        </span>\n        <span class="pull-right closing-icon">x</span>\n      </h3>\n    </div>\n    <div class="panel-body">\n      <div contenteditable="true" class="custom-typo text-muted note-content">'+t.content+'</div>\n      <div class="timestamps">\n        <small class="text-success"><span class="hidden-xs">Created at</span> '+t.created_at+'</small>\n        | <small class="text-warning"><span class="hidden-xs">Update at</span> '+t.updated_at+'</small>\n      </div>\n      <div class="buttons-block">\n        <button type="button" class="delete-button btn btn-danger btn-sm app-button">\n          Delete\n        </button>\n        <button type="button" class="edit-button btn btn-warning btn-sm app-button">\n          Edit\n        </button>\n      </div>\n    </div>\n  </div'};